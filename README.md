微博评论爬虫
-----------------

> 产品给了一个蛋疼的需求，任何一个在微博下评论并留下ID的人都给予一定奖励——他们本来认为可能只会有几十个评论，然后手动收集ID手动发放即可，谁知活动一出，一下来了7万条评论，于是在年前放假当天又加班到后半夜了~~

说说思路，其实微博的评论数据是很有规律的，在PC上用chrome打开微博，然后F12选择手机模式，选中一条微博进去，仅观看网络的XHR请求，从上往下滑动页面，则会发送一条条的请求，打开这些链接就可以发现是结构清晰的JSON格式了，请求链接格式如下

> http://m.weibo.cn/api/comments/show?id=4081146931187545&page=1

每条请求返回十个数据，以参数page累加，假如有10000条评论，那么请求page=1000就直接看到最后一条的评论了，再发送page=1001回复的json的ok字段就为0了

了解请求的方法之后，本以为随便用Node写一个httpget方法不断请求即可，简单测试后，就直接开始运行了，结果请求到700+的时候就悲剧了，再请求就直接返回报错了，无论如何都不行。然后发现是被封IP了，很悲剧。

正在测试IP代理的时候，同事找了一个前端请求加cookie的方法。测试可行。

结论就是前端请求加cookie，见consoleuse.js

其实这个方法也有缺点。由于是年前最后一项工作，待总结完善。
